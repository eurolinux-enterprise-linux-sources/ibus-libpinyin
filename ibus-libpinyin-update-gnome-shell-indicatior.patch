commit 9ef836117508d9c0c938f57a5ffa5ffca7eb2e7b
Author: Peng Wu <alexepico@gmail.com>
Date:   Fri Jul 26 13:03:44 2013 +0800

    Update the symbol of the ibus indicator

Index: ibus-libpinyin-1.6.91/src/PYPinyinProperties.cc
===================================================================
--- ibus-libpinyin-1.6.91.orig/src/PYPinyinProperties.cc
+++ ibus-libpinyin-1.6.91/src/PYPinyinProperties.cc
@@ -26,6 +26,7 @@
 namespace PY {
 
 #define _(text) (dgettext (GETTEXT_PACKAGE, text))
+#define N_(text) text
 
 PinyinProperties::PinyinProperties (Config & config)
     : m_config (config),
@@ -33,7 +34,7 @@ PinyinProperties::PinyinProperties (Conf
       m_mode_full (m_config.initFull ()),
       m_mode_full_punct (m_config.initFullPunct ()),
       m_mode_simp (m_config.initSimpChinese ()),
-      m_prop_chinese ("mode.chinese",
+      m_prop_chinese ("InputMode",
                 PROP_TYPE_NORMAL,
                 StaticText (m_mode_chinese ?
                             _("Chinese") :
@@ -83,6 +84,11 @@ PinyinProperties::PinyinProperties (Conf
                 "ibus-setup",
                 StaticText (_("Preferences")))
 {
+    if (m_mode_chinese)
+        m_prop_chinese.setSymbol(N_("中"));
+    else
+        m_prop_chinese.setSymbol(N_("英"));
+
     m_props.append (m_prop_chinese);
     m_props.append (m_prop_full);
     m_props.append (m_prop_full_punct);
@@ -98,6 +104,12 @@ PinyinProperties::toggleModeChinese (voi
     m_prop_chinese.setLabel (m_mode_chinese ?
                              _("Chinese") :
                              _("English"));
+
+    if (m_mode_chinese)
+        m_prop_chinese.setSymbol(N_("中"));
+    else
+        m_prop_chinese.setSymbol(N_("英"));
+
     m_prop_chinese.setIcon (m_mode_chinese ?
                             PKGDATADIR"/icons/chinese.svg" :
                             PKGDATADIR"/icons/english.svg");
@@ -177,7 +189,7 @@ PinyinProperties::reset (void)
 
 gboolean
 PinyinProperties::propertyActivate (const gchar *prop_name, guint prop_state) {
-    const static std::string mode_chinese ("mode.chinese");
+    const static std::string mode_chinese ("InputMode");
     const static std::string mode_full ("mode.full");
     const static std::string mode_full_punct ("mode.full_punct");
     const static std::string mode_simp ("mode.simp");
Index: ibus-libpinyin-1.6.91/src/PYProperty.h
===================================================================
--- ibus-libpinyin-1.6.91.orig/src/PYProperty.h
+++ ibus-libpinyin-1.6.91/src/PYProperty.h
@@ -55,6 +55,16 @@ public:
         ibus_property_set_icon (get<IBusProperty> (), icon);
     }
 
+    void setSymbol (IBusText *text)
+    {
+        ibus_property_set_symbol (get<IBusProperty> (), text);
+    }
+
+    void setSymbol (const gchar *text)
+    {
+        setSymbol (Text (text));
+    }
+
     void setSensitive (gboolean sensitive)
     {
         ibus_property_set_sensitive (get<IBusProperty> (), sensitive);
